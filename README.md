# Как работает проект

При запуске приложения создается папка "Extime" со следующими подпапками:
- **ExtimeContacts** - содержит файлы бекапов контактов, данных буфера, шаблонов.
- **TemplatesFiles** - содержит файлы, добавленные к шаблонам.
- **Old backup** - содержит старые бекапы контактов и буфера, добавляющиеся туда каждую новую сборку приложения.

Также туда сохраняются файлы с экспортом контактов в формате xls и баг репорты, обновляющиеся при крашах приложения.

Обвновление backup файлов с Contact и Clipboard запускается при закрытии приложения.

## База данных

В проекте используется БД Realm.
При закрытии приложения все связи с Realm закрываются и база сжимается для экономии памяти.
После создания новой транзакции связь необходимо закрывать.
Основные CRUD функции с базой данных хранятся в классе ContactCacheService.

## Разное

- Процедура чтения контактов с адресной книги и из файла находится в классе ContactsService. 
- 
- В модели контакта переменная "idContact" обозначает id контакта в адресной книге. Переменная "id" указывает же идентификатор в базе данных.

- Класс FabNotificationService используется для создания сервиса, который работает все время после запуска. Там же находятся функции для управления Voice.

- При каждом новом отправлении билда на проверку, Инкрементировать переменную versionDebug в классе MainActivity. В названии apk файла добавлять "_" + число из переменной versionDebug.
Это необходимо для манипуляции с файлами backup. 
Пример: app-debug_76

- В классах ParceToJsonClipboard и ParserToJson происходит парсинг буфера и контактов в json, в связи с тем что библиотека Gson использовала много памяти. При добавлении или изменении каких либо атрибутов классов Contact и Clipboard, вносить также изменения в классы с парсингом.

- Класс ClipboardType содержит регулярные выражения для определения типов данных, само определение типа данных происходит в том же классе.

- Класс FileType - производит распознавание типа файлов.

- Во вкладке Timeline получаются все сообщения с подключенных gmail аккаунтов. Содержит два режима отображения: List и Kanban.
## Классы, фрагменты и активити

**MainActivity** - единственная активность приложения, содержащая область для всех остальных фрагментов, содержит все popups, относящиеся к вкладке Contacts

**ContactsFragment** - фрагмент вкладки контактов, в нем же содержится ContactAdapter, для отображения списка контактов

**ProfileFragment** - фрагмент профиля контакта, содержащий viewpager

**EmailMessageFragment** - фрагмент для отображения письма в полный экран

**NewTemplateFragment** - фрагмент для отображения шаблона в полный экран

**NewTemplateEditFragment** - фрагмент для отображения шаблона в полный экран в режиме редактирования

**KanbanRowFragment** - фрагмент для отображения списка контактов в режиме kanban с ViewPager

**KanbanRowTimelineFragment** - фрагмент для отображения списка сообщений в режиме kanban с ViewPager

**ReplyFragment** - фрагмент для отправки сообщений через gmail api.

**ShareTemplatesMessageReply** - класс для вывода popup выбора шаблона или приложения для отправки сообщения

**TimeLineFragment** - фрагмент для отображения списка сообщений. Является по умолчанию, при открытии вкладки Timeline

**EmailsFragment** - фрагмент вкладки TEmails

**SwipeController** - класс для распознавания свайпа элементов буфера

**CreateFragment** - фрагмент создания нового контакта

**ContactTimelineDataFragment** - фрагмент содержащийся в viewpager профиля контакта, выводящий список сообщений. Сообщения получаются с помощью gmail api со всех почт, находящихся у контакта

**AvatarFragment** - фрагмент для отображения аватарки контакта, открывается из профиля контакта


## Модели данных

**Contact** - класс описывающий контакт, хранящий все данные о нем

**ContactInfo** - класс описывающий данные контакта

**HashTag** - класс описывающий хештеги контакта

**SocialModel** - класс описывающий основные социальные сети контакта

**Clipboard** - класс описывающий элемент буфера данных

**Template** - класс описывающий шаблон

**EmailMessage** - класс описывающий одно сообщение, полученное с помощью gmail api

**MessageData** - класс описывающий один файл, прикрепленный к сообщению


## Адаптеры

**AccountAdapter** - адаптер для вывода списка gmail аккаунтов устройства

**ClibpboardAdapter** - адаптер для вывода списка данных буфера

**ContactAdapter** - адаптер для вывода списка контактов

**ContactNumberAdapter** - адаптер для вывода списка данных контакта в профиле в режиме просмотра

**ContactNumberEditAdapter** - адаптер для вывода списка данных контакта в профиле в режиме редактирования

**MessageAdapter** - адаптер для вывода списка сообщений, используется в ContactTimelineDataFragment и TimeLineFragment

